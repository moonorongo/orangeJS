<html>
    <head>
        <!-- libs -->
        <script src="js/underscore.js"></script> 
        <!-- main lib -->
        <script src="js/orange2.js"></script> 
        <!-- classes -->
        <script src="js/class.layer.js"></script> 
        <script src="js/class.image_manager.js"></script> 
        <script src="js/class.image_map.js"></script> 
        <script src="js/class.sprite.js"></script> 
        <script src="js/class.constant.js"></script> 
        
</head>

    <body>

    </body>
    
<script>
    Orange.init();
    Orange.getImageManager().addImage(["img/bg.png","img/overfg.png", "img/pacman2.png", "img/floor.png"]);
    var pacman_s, x=0, y=0, dx=0, dy=0, l;
    
    
    Orange.getImageManager().preload(function(){
    
        var pacman_im = new Orange.ImageMap(Orange.getImageManager().get("pacman"), 16,16);
        pacman_s = new Orange.Sprite({
            src : pacman_im 
        });

        l = new Orange.Layer();
        Orange.addLayer(l);
        l.setBackground(Orange.getImageManager().get("floor.png"));
        l.setBoundary(Orange.getImageManager().get("floor.png"))
        
        l.addSprite(pacman_s); 

        pacman_s.setX(0).setY(120);

/*
        pacman_s.on("mousedown", function(eventData) {
            //console.log(extra);
            if(eventData.extra.clicked) console.log("clicked");
        });
*/
        
        pacman_s.on("keydown", function(eventData, s) {
            switch(eventData.e.keyCode) {
                case 38 :   dy = -s.getSpeed();
                            break;
                case 40 :   dy = s.getSpeed();
                            break;
                case 39 :   dx = s.getSpeed();
                            break;
                case 37 :   dx = -s.getSpeed();
                            break;
            }
            
        });

        pacman_s.on("keyup", function(eventData, s) {
            switch(eventData.e.keyCode) {
                case 38 :   dy = 0;
                            break;
                case 40 :   dy = 0;
                            break;
                case 39 :   dx = 0;
                            break;
                case 37 :   dx = 0;
                            break;
            }
        });
        
/*        
        var m = new Orange.Layer();
        m.setBackground(Orange.getImageManager().get("overfg"));
        Orange.addLayer(m);
*/        
        Orange.setMainCallback(function() {
            
            pacman_s.incX(dx).incY(dy);

        });
        
        Orange.start();
        //Orange.stop();
    }); // preload
    

    
</script>
</hmtl>